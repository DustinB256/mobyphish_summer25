<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>BantyBank</title>
  <style>
    /* palette & layout */
    *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif}
    body{background:#f2f2f2;min-height:100vh;display:flex;flex-direction:column;color:#333}
    header{background:#004b8d;color:#fff;padding:12px 20px;display:flex;justify-content:space-between;align-items:center}
    main{flex:1;display:flex;justify-content:center;align-items:center;padding:30px}
    .card{background:#fff;padding:30px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.1);width:100%;max-width:400px;text-align:center}
    input{width:100%;padding:9px;border:1px solid #aaa;border-radius:4px;margin-top:6px}
    button{margin-top:20px;padding:10px 18px;background:#004b8d;color:#fff;border:none;border-radius:4px;cursor:pointer}
    button:hover{background:#00356b}
    .error{color:#e63946;font-size:.9rem;margin-top:10px}
    #reportBtn{position:fixed;bottom:20px;right:20px;background:#e63946;color:#fff;border:none;border-radius:50px;padding:12px 18px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2)}
    #reportBtn:hover{background:#c5303f}
  </style>
</head>
<body>
<header><h1>BantyBank</h1></header>

<main>
  <!-- LOGIN -->
  <div id="loginCard" class="card">
    <h2>Secure Login</h2>
    <input id="acc" placeholder="Account #" />
    <input id="pwd" type="password" placeholder="Password" />
    <button id="loginBtn">Login</button>
    <div id="loginErr" class="error"></div>
  </div>

  <!-- TASK -->
  <div id="taskCard" class="card" style="display:none">
    <h2>Pending Approval</h2>
    <p style="margin:18px 0">Transfer <strong>$250</strong> to account <strong>987654321</strong>.</p>
    <button id="approveBtn">Approve Transfer</button>
  </div>

  <!-- SUCCESS -->
  <div id="doneCard" class="card" style="display:none">
    <h2>Transfer Approved âœ…</h2>
    <p>Task complete. Please close this tab and open your email for the next task.</p>
  </div>
</main>

<button id="reportBtn">ðŸš¨ Report Phish</button>

<script>
(() => {
  /* hard-coded study vars */
  const siteName = "BantyBank";
  const validAccount = "test", validPassword = "test";
  const userId = 123;                 // replace via pre-survey / localStorage

  /* helper â€“ POST a single line to /log */
  const log = text =>
    fetch("http://localhost:5001/log", {
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({user_id:userId, text})
    }).catch(err=>console.warn("log failed",err));

  /* DOM */
  const $ = id => document.getElementById(id);
  const loginCard=$("loginCard"), taskCard=$("taskCard"), doneCard=$("doneCard");

  /* Login flow */
  $("loginBtn").onclick = () => {
    if ($("acc").value.trim()===validAccount && $("pwd").value.trim()===validPassword){
      $("loginErr").textContent="";
      loginCard.style.display="none";
      taskCard.style.display="block";
      log(`User ${userId} logged into ${siteName} at ${new Date().toISOString()}`);
    } else {
      $("loginErr").textContent="Invalid credentials.";
    }
  };

  /* Approve task */
  $("approveBtn").onclick = () => {
    //log("Task complete. Please close this tab and open your email for the next task.");
    taskCard.style.display="none";
    doneCard.style.display="block";
  };

  /* Report phishing */
  $("reportBtn").onclick = () => {
    if(!confirm("Report this site as phishing?")) return;
    log(`User ${userId} reported ${siteName} as phishing at ${new Date().toISOString()}`);
    alert("Thank you for reporting. Please return to your email for the next task.");
    location.reload();
  };
})();
</script>
</body>
</html>
