<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>LendBank</title>
<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:Arial,sans-serif}
  body{background:#eef5db;min-height:100vh;display:flex;flex-direction:column;color:#2f3e46}
  header{background:#1a535c;color:#fff;padding:12px 20px;display:flex;align-items:center}
  main{flex:1;display:flex;justify-content:center;align-items:center;padding:30px}
  .card{background:#fff;padding:30px;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,.1);width:100%;max-width:400px;text-align:center}
  input{width:100%;padding:9px;border:1px solid #aaa;border-radius:4px;margin-top:6px}
  button{margin-top:20px;padding:10px 18px;background:#1a535c;color:#fff;border:none;border-radius:4px;cursor:pointer}
  button:hover{background:#163e3f}
  .error{color:#ef476f;font-size:.9rem;margin-top:10px}
  #reportBtn{position:fixed;bottom:20px;right:20px;background:#ef476f;color:#fff;border:none;border-radius:50px;padding:12px 18px;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,.2)}
  #reportBtn:hover{background:#d0004c}
</style>
</head>
<body>
<header><h1>LendBank</h1></header>

<main>
  <!-- Login -->
  <div id="loginCard" class="card">
    <h2>Secure Login</h2>
    <input id="acc" placeholder="Account #" />
    <input id="pwd" type="password" placeholder="Password" />
    <button id="loginBtn">Login</button>
    <div id="loginErr" class="error"></div>
  </div>

  <!-- Task -->
  <div id="taskCard" class="card" style="display:none">
    <h2>Pending Approval</h2>
    <p style="margin:18px 0">Transfer <strong>$250</strong> to account <strong>987654321</strong>.</p>
    <button id="approveBtn">Approve Transfer</button>
  </div>

  <!-- Success -->
  <div id="doneCard" class="card" style="display:none">
    <h2>Transfer Approved âœ…</h2>
    <p>Please close this tab and open your email for the next task.</p>
  </div>
</main>

<button id="reportBtn">ðŸš¨ Report Phish</button>

<script>
(() => {
  const siteName="LendBank";
  const validAccount="test", validPassword="test";
  const userId=123;                     // inject per participant if needed

  const log = txt => fetch("http://localhost:5001/log",{
      method:"POST",headers:{"Content-Type":"application/json"},
      body:JSON.stringify({user_id:userId,text:txt})}).catch(()=>{});

  const $=id=>document.getElementById(id);
  const loginCard=$("loginCard"),taskCard=$("taskCard"),doneCard=$("doneCard");

  $("loginBtn").onclick=()=>{
    if($("acc").value.trim()===validAccount && $("pwd").value.trim()===validPassword){
      $("loginErr").textContent="";
      loginCard.style.display="none";
      taskCard.style.display="block";
      log(`User ${userId} logged into ${siteName} at ${new Date().toISOString()}`);
    }else{$("loginErr").textContent="Invalid credentials.";}
  };
  $("approveBtn").onclick=()=>{
      //log("Task complete. please close this tab and open your email for the next task");
      taskCard.style.display="none"; doneCard.style.display="block";
  };
  $("reportBtn").onclick=()=>{
    if(!confirm("Report this site as phishing?"))return;
    log(`User ${userId} reported ${siteName} as phishing at ${new Date().toISOString()}`);
    alert("Thank you. Return to your email for the next task."); location.reload();
  };
})();
</script>
</body></html>
